import{g as ge,e as Pe,r as L,d as A,f as pe,o as f,h as S,i as u,a as p,u as e,I as O,_ as ne,j as we,k as Re,l as me,c as k,w as x,S as Se,m as Ue,n as Oe,p as Le,q as Ie,s as te,t as Fe,v as T,x as ae,y as Ne,z as Ae,A as ke,C as Ge,E as Ye,F as je,G as _e,H as ee,J as Xe,K as E,L as he,N as ye,O as qe,P as We,Q as F,R as P,T as N,U as Ke,V as Ze,M as He,W as ve,X as oe,Y as Je,Z as Qe,$ as Ee,a0 as Z,a1 as K,a2 as et,a3 as tt,a4 as at,a5 as ot,a6 as nt,a7 as st,a8 as be,a9 as lt,aa as rt,ab as it,ac as ct,ad as ut,ae as dt,af as pt,ag as mt,ah as vt,ai as ft,aj as gt,ak as _t,al as ht,am as W,an as yt,ao as se,ap as le,aq as Me,ar as re,as as bt,at as Mt,au as ie,av as Ct,aw as $t,ax as Ce,ay as xt,az as $e,aA as ce,aB as ue,aC as wt,aD as xe}from"./index-C8O7XfGe.js";const de="map-compare";function Be(t){Pe(t,de,{setting:L({compare:!0,split:!0,sync:!0,vertical:!1})})}function St(t){const m=ge(t,de);return m||(Be(t),ge(t,de))}function H(t){return St(t).setting}const Lt={class:"setting-field-container"},It=A({__name:"CompareSettingCard",props:{mapId:{type:String,required:!0}},setup(t){const m=t,{trans:r,setLocaleDefault:i}=pe(m.mapId);i({map:{"setting-control":{title:"Setting",field:{compare:"compare",split:"split",sync:"sync",vertical:"vertical"},btn:{apply:"Apply"}}}});const v=H(m.mapId);return(_,c)=>(f(),S("div",Lt,[u("div",null,[p(e(O),{label:e(r)("map.setting-control.field.split"),modelValue:e(v).split,"onUpdate:modelValue":c[0]||(c[0]=a=>e(v).split=a)},null,8,["label","modelValue"])]),u("div",null,[p(e(O),{label:e(r)("map.setting-control.field.vertical"),modelValue:e(v).vertical,"onUpdate:modelValue":c[1]||(c[1]=a=>e(v).vertical=a)},null,8,["label","modelValue"])]),u("div",null,[p(e(O),{label:e(r)("map.setting-control.field.sync"),modelValue:e(v).sync,"onUpdate:modelValue":c[2]||(c[2]=a=>e(v).sync=a)},null,8,["label","modelValue"])])]))}}),kt=ne(It,[["__scopeId","data-v-9e9523d0"]]),Et={class:"setting-container"},Bt={class:"setting-field-container"},Vt=A({__name:"CompareSettingControl",props:{...we},setup(t){const m=t,[r,i]=Re(!1),{mapId:v,moduleContainerProps:_}=me(m),{trans:c,setLocaleDefault:a}=pe(v.value);a({map:{"setting-control":{title:"Setting",field:{compare:"compare",split:"split",sync:"sync",vertical:"vertical"},btn:{apply:"Apply"}}}});const l=H(v.value);return(n,o)=>(f(),k(ke,Ne(Ae(e(_))),{btn:x(()=>[p(Le,{onClick:o[0]||(o[0]=Oe(s=>e(i)(),["stop"])),tooltip:e(c)("map.setting-control.title")},{default:x(()=>[p(e(Se),{size:18,type:"mdi",path:e(Ue)},null,8,["path"])]),_:1},8,["tooltip"])]),draggable:x(s=>[e(r)?(f(),k(e(Ie),te({key:0,height:400,width:400},s,{show:e(r),"onUpdate:show":o[4]||(o[4]=d=>Fe(r)?r.value=d:null),title:e(c)("map.setting-control.title")}),{default:x(()=>[u("div",Et,[u("div",Bt,[u("div",null,[p(e(O),{label:e(c)("map.setting-control.field.split"),modelValue:e(l).split,"onUpdate:modelValue":o[1]||(o[1]=d=>e(l).split=d)},null,8,["label","modelValue"])]),u("div",null,[p(e(O),{label:e(c)("map.setting-control.field.vertical"),modelValue:e(l).vertical,"onUpdate:modelValue":o[2]||(o[2]=d=>e(l).vertical=d)},null,8,["label","modelValue"])]),u("div",null,[p(e(O),{label:e(c)("map.setting-control.field.sync"),modelValue:e(l).sync,"onUpdate:modelValue":o[3]||(o[3]=d=>e(l).sync=d)},null,8,["label","modelValue"])])])])]),_:2},1040,["show","title"])):T("",!0)]),default:x(()=>[ae(n.$slots,"default")]),_:3},16))}});function zt(t,m){var r=t.getCenter(),i=t.getZoom(),v=t.getBearing(),_=t.getPitch();m.forEach(function(c){c.jumpTo({center:r,zoom:i,bearing:v,pitch:_})})}function Dt(){var t,m=arguments.length;if(m===1)t=arguments[0];else{t=[];for(var r=0;r<m;r++)t.push(arguments[r])}var i=[];t.forEach(function(a,l){i[l]=c.bind(null,a,t.filter(function(n,o){return o!==l}))});function v(){t.forEach(function(a,l){a.on("move",i[l])})}function _(){t.forEach(function(a,l){a.off("move",i[l])})}function c(a,l){_(),zt(a,l),v()}return v(),function(){_(),i=[],t=[]}}var Tt=Dt;const Pt=Ge(Tt);function Rt(t,m,r){let i=r.getBoundingClientRect();const v=()=>{i=r.getBoundingClientRect()},_=g=>{let w=("touches"in g?g.touches[0].clientX:g.clientX)-i.left;return w=Math.max(0,Math.min(w,i.width)),w},c=g=>{const y=`translate(${g}px, 0)`;t.style.transform=y,t.style.webkitTransform=y,m.style.clip=`rect(0, ${g}px, ${i.height}px, 0)`,r.style.clip=`rect(0, 999em, ${i.height}px, ${g}px)`},a=g=>{c(_(g))},l=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l)},n=()=>{document.removeEventListener("touchmove",a),document.removeEventListener("touchend",n)},o=g=>{"touches"in g?(document.addEventListener("touchmove",a,{passive:!1}),document.addEventListener("touchend",n)):(document.addEventListener("mousemove",a),document.addEventListener("mouseup",l))};t.addEventListener("mousedown",o),t.addEventListener("touchstart",o,{passive:!1});const s=()=>{t.removeEventListener("mousedown",o),t.removeEventListener("touchstart",o),m.style.clip="",r.style.clip=""},d=i.width/2;return c(d),{clear:s,resize:v}}function Ut(t,m,r){let i=r.getBoundingClientRect();const v=()=>{i=r.getBoundingClientRect(),c(i.height/2)},_=s=>{const g=("touches"in s?s.touches[0].clientY:s.clientY)-i.top;return Math.max(0,Math.min(g,i.height))},c=s=>{t.style.transform=`translateY(${s}px)`,m.style.clipPath=`inset(0px 0px ${i.height-s}px 0px)`,r.style.clipPath=`inset(${s}px 0px 0px 0px)`},a=s=>{s.preventDefault(),c(_(s))},l=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",l)},n=s=>{"touches"in s?(document.addEventListener("touchmove",a,{passive:!1}),document.addEventListener("touchend",l)):(document.addEventListener("mousemove",a),document.addEventListener("mouseup",l))};t.addEventListener("mousedown",n),t.addEventListener("touchstart",n,{passive:!1});const o=()=>{t.removeEventListener("mousedown",n),t.removeEventListener("touchstart",n),l(),m.style.clipPath="",r.style.clipPath=""};return c(i.height/2),{clear:o,resize:v}}const Ve=t=>(Je("data-v-9db82173"),t=t(),Qe(),t),Ot={key:0,class:""},Ft=Ve(()=>u("div",{class:"not-support-map"},[u("p",{class:""}," Trình duyệt của bạn không hỗ trợ hiển thị bản đồ, vui lòng đổi trình duyệt hoặc cập nhật bản mới để xem. ")],-1)),Nt=[Ft],At=["mapId"],Gt=Ve(()=>u("div",{class:"compare-swiper-icon"},null,-1)),Yt=[Gt],jt=["id"],Xt=["id"],qt=["id"],Wt=["id"],Kt=A({__name:"MapCompare",props:{mapboxAccessToken:{type:String,default:""},initOptions:{type:Object,default:()=>({attributionControl:!1,zoomControl:!1})},dragId:{type:String}},emits:["map-loaded","map-destroy"],setup(t,{emit:m}){const r=Ye({mobile:0,tablet:640,laptop:1024,desktop:1280}),i=t;function v(){if(window.WebGLRenderingContext){const h=document.createElement("canvas");try{const $=h.getContext("webgl2")||h.getContext("webgl");if($&&typeof $.getParameter=="function")return!0}catch{}return!1}return!1}const _=m,c=L(2),a=L(v()),l=L(!1),n=L(je());_e(()=>{ee(()=>{o(),window.addEventListener("resize",o)})});function o(){C&&C()}Xe(()=>{window.removeEventListener("resize",o),De()});let s=[];const d=E(()=>`map-draggable-${n.value}`),g=E(()=>`bottom-right-${n.value}`),y=E(()=>`bottom-left-${n.value}`),w=E(()=>`top-right-${n.value}`),G=E(()=>`top-left-${n.value}`);he("$map.dragId",i.dragId||d.value),he("$map.id",n.value);const R=r.smallerOrEqual("tablet");function M(h,$){s[$]=h,ze()}function I(h,$){delete s[$]}let B,b,C;const V=L(null),Y=L([]),j=L([]),D=L({compare:!0,split:!0,sync:!0,vertical:!1}),J=E(()=>D.value.compare&&D.value.split);let X=null;function ze(){s&&(Array.from({length:c.value},(h,$)=>$).some(h=>!s[h])||(l.value=!0,ee(()=>{_("map-loaded",{id:n.value,maps:s})}),s.forEach(h=>{h&&h.resize()}),ve.actions.initMaps(n.value,s),Be(n.value),oe(n,h=>{if(!h)return;X&&X();const $=H(h);X=oe($,z=>{D.value={...z},ee(()=>{fe()})},{deep:!0})},{immediate:!0}),fe()))}function De(){B&&B(),b&&b(),ye.removeMap(n.value),ee(()=>{s=[]}),X&&X()}function fe(){var h,$,z,U;if(B&&B(),b&&b(),c.value=D.value.compare?2:1,J.value&&V.value){const q=D.value.vertical?Ut(V.value,(h=Y.value)==null?void 0:h[0].$el,($=Y.value)==null?void 0:$[1].$el):Rt(V.value,(z=Y.value)==null?void 0:z[0].$el,(U=Y.value)==null?void 0:U[1].$el);B=q.clear,C=q.resize}D.value.sync&&(b=Pt(s)),s.forEach(q=>{q&&q.resize()})}let Q;const Te=qe.debounce(h=>{h.contentRect,ye.getMap(n.value,$=>{$.resize()}),C&&C()},200);return _e(()=>{Q=new ResizeObserver(h=>{for(const $ of h)Te($)}),j.value&&Q.observe(j.value)}),We(()=>{Q&&j.value&&Q.unobserve(j.value)}),(h,$)=>a.value?(f(),S("div",{key:1,class:F(["map-compare-container",{"map-mobile-container":e(R)}]),mapId:n.value},[u("div",{class:"map-viewer",ref_key:"containerRef",ref:j},[u("div",{class:F(["map-compare__container",{"map-compare__split-vertical":J.value&&!D.value.vertical,"map-compare__split-horizontal":J.value&&D.value.vertical}])},[(f(!0),S(P,null,N(c.value,z=>(f(),k(He,te({key:z,ref_for:!0},h.$attrs,{class:"map-compare__item",dragId:d.value,ref_for:!0,ref_key:"mapsRef",ref:Y,onMapLoaded:U=>M(U,z-1),onMapDestroy:U=>I(U,z-1),initOptions:t.initOptions}),{default:x(()=>[l.value?ae(h.$slots,`map-${z-1}`,{key:0},void 0,!0):T("",!0)]),_:2},1040,["dragId","onMapLoaded","onMapDestroy","initOptions"]))),128)),J.value?(f(),S("div",{key:0,class:"map-compare__swiper",ref_key:"swiperRef",ref:V},Yt,512)):T("",!0)],2),i.dragId?T("",!0):(f(),S(P,{key:0},[u("div",{class:"right-bottom-container",id:g.value},null,8,jt),u("div",{class:"left-bottom-container",id:y.value},null,8,Xt),u("div",{class:"right-top-container",id:w.value},null,8,qt),u("div",{class:"left-top-container",id:G.value},null,8,Wt),p(e(Ke),{class:"drag-container","container-id":d.value},null,8,["container-id"])],64)),l.value?ae(h.$slots,"default",{key:1},void 0,!0):T("",!0),l.value?(f(),k(Ze,{key:2,mapId:n.value},null,8,["mapId"])):T("",!0)],512)],10,At)):(f(),S("div",Ot,Nt))}}),Zt=ne(Kt,[["__scopeId","data-v-9db82173"]]),Ht={class:"base-map-card"},Jt={class:"base-map-card__image"},Qt={class:"base-map-card__content"},ea=A({__name:"CompareBaseMapCard",props:{mapId:{type:String,required:!0},title:{type:String,default:""}},setup(t){var n;const m=t,{mapId:r}=me(m),i=H(r.value),v=L(((n=ve.actions.getMapStore(r.value))==null?void 0:n.maps.map(o=>o.id))||[]),_=E(()=>a.value.map(o=>o.currentBaseMap)),c=E(()=>a.value.map(o=>o.baseMaps)),a=E(()=>v.value.map(o=>Ee(o))),l=(o,s)=>{a.value[o].setCurrent(s)};return(o,s)=>(f(),S("div",Ht,[u("div",Jt,[_.value?(f(),k(e(Z),{key:0},{default:x(()=>[u("div",{class:F(["base-map-item-image-container",{_vertical:e(i).vertical}])},[(f(!0),S(P,null,N(_.value,(d,g)=>{var y;return f(),k(e(Z),{src:(y=d.value)==null?void 0:y.thumbnail,key:g,class:"base-map-item-image"},null,8,["src"])}),128))],2)]),_:1})):T("",!0)]),u("div",Qt,[(f(!0),S(P,null,N(c.value,(d,g)=>(f(),S("div",{key:g,class:"base-map-card__item"},[u("div",null,"#"+K(g+1),1),u("div",null,[p(e(et),{modelValue:_.value[g].value,items:d.value,returnObject:"",itemText:"title",itemValue:"id","onUpdate:modelValue":y=>l(g,y)},null,8,["modelValue","items","onUpdate:modelValue"])])]))),128))])]))}}),ta=ne(ea,[["__scopeId","data-v-b09c9e4e"]]),aa={class:"base-map-button__content"},oa={class:"base-map-button__title"},na={class:""},sa={key:1},la={class:"control-container"},ra={class:"tabs-container"},ia=["onClick"],ca={class:"basemap-container"},ua={class:"base-map-control-setting"},da=["title","onClick"],pa={class:"base-map-control-setting-item__title",style:{"font-size":"14px"}},ma=A({__name:"CompareBaseMapControl",props:{...we,baseMaps:{type:Array,default:()=>tt},title:{type:String,default:""},defaultBaseMap:{type:String,default:"Open Street Map"},controlIcon:{type:String,default:""}},setup(t){var R;const m=t,{mapId:r,moduleContainerProps:i}=me(m),v=H(r.value),{trans:_,setLocaleDefault:c}=pe(r.value),a=L(0),l=L(((R=ve.actions.getMapStore(r.value))==null?void 0:R.maps.map(M=>M.id))||[]),n=E(()=>l.value.map(M=>Ee(M))),o=E(()=>n.value.map(M=>M.currentBaseMap)),s=E(()=>n.value.map(M=>M.baseMaps));oe(()=>m.baseMaps,M=>{n.value.forEach(I=>{I.setBaseMaps(M)})},{immediate:!0}),oe(()=>m.defaultBaseMap,M=>{n.value.forEach(I=>{I.setDefaultBaseMap(M)})},{immediate:!0}),c({map:{basemap:{title:"Map basemap",setting:"Setting"}}});const d=E(()=>70),g={layer:st},y=L(!1);function w(M,I){n.value[M].setCurrent(I)}function G(){y.value=!y.value}return(M,I)=>(f(),k(e(ke),te(e(i),{btnWidth:70}),{btn:x(()=>[o.value?(f(),k(e(Le),{key:0,tooltip:t.title},{content:x(()=>[p(e(nt),{class:"clickable base-map-button__container",height:"70px",width:"70px",onClick:G},{default:x(()=>[u("div",aa,[p(e(Z),null,{default:x(()=>[u("div",{class:F(["base-map-item-image-container",{_vertical:e(v).vertical}])},[(f(!0),S(P,null,N(o.value,(B,b)=>{var C;return f(),k(e(Z),{src:(C=B.value)==null?void 0:C.thumbnail,key:b,class:"base-map-item-image"},null,8,["src"])}),128))],2),u("div",oa,[t.controlIcon?(f(),k(e(at),{key:0,dark:"",small:""},{default:x(()=>[ot(K(t.controlIcon),1)]),_:1})):(f(),k(e(Se),{key:1,type:"mdi",path:g.layer},null,8,["path"])),u("div",na,K(t.title||e(_)("map.basemap.title")),1)])]),_:1})])]),_:1})]),_:1},8,["tooltip"])):(f(),S("div",sa))]),draggable:x(B=>[y.value?(f(),k(e(Ie),te({key:0},B,{height:d.value*2+48+10+40,show:y.value,"onUpdate:show":I[0]||(I[0]=b=>y.value=b),"is-resizable":!1,title:e(_)("map.basemap.setting"),width:d.value*3+24}),{default:x(()=>[u("div",la,[u("div",ra,[(f(!0),S(P,null,N(s.value,(b,C)=>(f(),S("div",{key:C,class:F(["tab-item",{_active:a.value==C}]),onClick:V=>a.value=C}," #"+K(C+1),11,ia))),128))]),u("div",ca,[u("div",ua,[(f(!0),S(P,null,N(s.value[a.value].value,b=>{var C;return f(),S("div",{key:b.id,class:F(["clickable base-map-control-setting-item",{"base-map-control-setting-item__active":o.value&&o.value[a.value]&&o.value[a.value].value&&b.id==((C=o.value[a.value].value)==null?void 0:C.id)}]),style:be({width:d.value+"px"}),title:b.title,onClick:V=>w(a.value,b)},[u("div",{style:be({width:d.value-34+"px",height:d.value-34+"px"})},[p(e(Z),{src:b.thumbnail},null,8,["src"])],4),u("div",pa,K(b.title),1)],14,da)}),128))])])])]),_:2},1040,["height","show","title","width"])):T("",!0)]),default:x(()=>[ae(M.$slots,"default",{},void 0,!0)]),_:3},16))}}),va=ne(ma,[["__scopeId","data-v-94238b78"]]),ga=A({__name:"AllMapCompareView",setup(t){const m=L();function r(i){const v=W("Group test",null,!0),_=yt("source",{name:"raster 1",type:"raster",tiles:["https://naturalearthtiles.roblabs.com/tiles/natural_earth_cross_blended_hypso_shaded_relief.raster/{z}/{x}/{y}.png"],maxzoom:6,bounds:[104.96327341667353,18.461221184685627,106.65936430823979,19.549518287564368]}),c=se("layer raster",[{type:"raster"}]),a=le("test raster");a.color="#0000FF";const l=W("Group layer 1",null,!0);v.add(_),l.add(a),l.add(c),v.add(l),a.addMenu(Me()),a.addMenu(re());const n=W("Group test",null,!0),o=bt("source",{type:"FeatureCollection",features:[]}),s=W("Group layer 1",null,!0),d=le("test area");d.color="#0000FF",d.legend=Mt([{type:"text",value:{text:"text-test",value:"test-value"}},{type:"linear",value:{text:"legend linear",items:[{value:"test 1",color:"#fff"},{value:"test 2",color:"#000"},{value:"test 3",color:"red"}]}}]);const g=se("layer area",[new ie().setStyleType("area").setColor(d.color).setOpacity(.5).build()]);s.add(g),s.add(d);const y=W("Group layer 2",null,!0),w=le("test point");w.color="#ff0000",w.legend=Ct("color",{text:"color-test",color:"#fff"});const G=se("layer point",[new ie().setStyleType("point").setColor(w.color).setOpacity(w.opacity).build(),new ie().setStyleType("line").setColor(w.color).setOpacity(.5).build()]);d.addMenus([re(),Me(),$t()]),w.addMenus([re()]);const R=Ce("metadata for list2",{bbox:[105.88454157202995,20.878811643339404,106.16710803591963,21.0854254401454]}),M=Ce("metadata",{bbox:[104.96327341667353,18.461221184685627,107.53334783357559,20.18022781865689]}),I=xt("test identify"),B=$e("test identify 1"),b=$e("test identify 2");I.addMenus([ce(),ue()]),B.addMenus([ce(),ue()]),b.addMenus([ce(),ue()]);const C={id:"test",name:"test"};d.group=C,s.add(B),w.group=C,y.add(G),y.add(w),y.add(b),y.add(R);const V=wt("data management",{fields:[{text:"Name rat dai rat dai rat dai rat dai",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"}]});V.setItems([{id:"1",name:"feature 1",geometry:{coordinates:[[[104.96327341667353,19.549518287564368],[104.96327341667353,18.461221184685627],[106.65936430823979,18.461221184685627],[106.65936430823979,19.549518287564368],[104.96327341667353,19.549518287564368]]],type:"Polygon"}},{id:"2",name:"feature 2",geometry:{coordinates:[[[105.80782070639765,20.18022781865689],[105.80782070639765,18.841791883714322],[107.53334783357559,18.841791883714322],[107.53334783357559,20.18022781865689],[105.80782070639765,20.18022781865689]]],type:"Polygon"}}]),n.add(o),n.add(V),n.add(s),n.add(y),n.add(I),n.add(M),xe(i.id,v),xe(i.id,n)}return(i,v)=>(f(),k(e(Zt),{ref_key:"mapRef",ref:m,onMapLoaded:r},{default:x(()=>[p(e(lt)),p(e(Vt)),p(e(rt),{position:"top-right"}),p(e(it),{position:"top-left",show:""},{endList:x(({mapId:_})=>[p(e(ta),{mapId:_},null,8,["mapId"]),p(e(kt),{mapId:_},null,8,["mapId"])]),_:1}),p(e(ct),{position:"top-right",immediately:""}),p(e(ut),{position:"top-right"}),p(e(dt)),p(e(pt)),p(e(mt)),p(e(vt)),p(e(ft)),p(e(gt)),p(e(_t)),p(e(va),{position:"bottom-left"}),p(e(ht))]),_:1},512))}});export{ga as default};
