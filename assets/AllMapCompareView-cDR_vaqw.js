import{q as _e,t as we,v as xe,x as Ge,y as me,z as pe,A as x,C as Q,E as Le,d as Y,G as ne,H as ve,j as w,o as g,b as m,a as f,u as e,I as F,J as oe,K as ke,N as Ne,c as k,O as Ee,P as Ye,Q as je,w as S,R as ee,S as R,T as Ie,U as te,V as Xe,W as Be,X as qe,Y as Ke,Z as Ve,$ as We,a0 as He,a1 as Je,a2 as Ze,a3 as se,a4 as E,a5 as he,a6 as Qe,a7 as et,a8 as fe,a9 as G,F as O,r as N,l as tt,aa as at,ab as nt,ac as Pe,ad as ze,ae as H,af as W,ag as ot,ah as st,ai as be,aj as Me,ak as lt,al as rt,am as it,an as ut,ao as ct,ap as dt,aq as pt,ar as mt,_ as vt,as as ft,f as gt,at as yt,g as _t,h as ht,i as bt,M as Mt,au as Ct,av as $t,aw as K,ax as St,ay as le,az as re,aA as Ce,aB as ie,aC as wt,aD as xt,L as ue,aE as Lt,aF as kt,aG as $e,aH as Et,aI as Se,aJ as ce,aK as de,aL as It}from"./index-CRtOk2sP.js";const ae={set:"map:compare:set-setting"};function Te(t){we(xe,t,"store").debug("init"),Ge(t,pe.MAP_COMPARE,{setting:{compare:!0,split:!0,sync:!0,vertical:!1}})}function De(t){const r=_e(t,pe.MAP_COMPARE);return r||(Te(t),_e(t,pe.MAP_COMPARE))}function ge(t){const r=De(t);return r==null?void 0:r.setting}function Bt(t,r){we(xe,t,"store").debug("updateMapCompareSetting",r);const o=De(t);o&&(o.setting={...o.setting,...r}),me(t).emit(ae.set,{...o==null?void 0:o.setting,...r})}const Re=(t,{onChange:r}={})=>{const o=x(ge(t)||{});function u(){Bt(t,o.value)}function y(p){o.value=p,r&&r(p)}const d=me(t);return Q(()=>{d.on(ae.set,y)}),Le(()=>{d.off(ae.set,y)}),{updateSetting:u,setting:o}},Vt={class:"setting-field-container"},Pt=Y({__name:"CompareSettingCard",props:{mapId:{type:String,required:!0}},setup(t){const r=t,{mapId:o}=ne(r),{trans:u,setLocaleDefault:y}=ve(r.mapId);y({map:{"setting-control":{title:"Setting",field:{compare:"compare",split:"split",sync:"sync",vertical:"vertical"},btn:{apply:"Apply"}}}});const{setting:d,updateSetting:p}=Re(o.value);return(c,a)=>(g(),w("div",Vt,[m("div",null,[f(e(F),{label:e(u)("map.setting-control.field.split"),modelValue:e(d).split,"onUpdate:modelValue":a[0]||(a[0]=n=>e(d).split=n),onChange:a[1]||(a[1]=n=>e(p)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(u)("map.setting-control.field.vertical"),modelValue:e(d).vertical,"onUpdate:modelValue":a[2]||(a[2]=n=>e(d).vertical=n),onChange:a[3]||(a[3]=n=>e(p)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(u)("map.setting-control.field.sync"),modelValue:e(d).sync,"onUpdate:modelValue":a[4]||(a[4]=n=>e(d).sync=n),onChange:a[5]||(a[5]=n=>e(p)())},null,8,["label","modelValue"])])]))}}),zt=oe(Pt,[["__scopeId","data-v-bd61d51f"]]),Tt={class:"setting-container"},Dt={class:"setting-field-container"},Rt=Y({__name:"CompareSettingControl",props:{...ke},setup(t){const r=t,[o,u]=Ne(!1),{mapId:y,moduleContainerProps:d}=ne(r),{trans:p,setLocaleDefault:c}=ve(y.value);c({map:{"setting-control":{title:"Setting",field:{compare:"compare",split:"split",sync:"sync",vertical:"vertical"},btn:{apply:"Apply"}}}});const{setting:a,updateSetting:n}=Re(y.value);return(i,l)=>(g(),k(Ee,Ye(je(e(d))),{btn:S(()=>[f(Ve,{onClick:l[0]||(l[0]=Ke(v=>e(u)(),["stop"])),tooltip:e(p)("map.setting-control.title")},{default:S(()=>[f(e(Be),{size:18,type:"mdi",path:e(qe)},null,8,["path"])]),_:1},8,["tooltip"])]),draggable:S(v=>[e(o)?(g(),k(e(Ie),te({key:0,height:400,width:400},v,{show:e(o),"onUpdate:show":l[7]||(l[7]=s=>Xe(o)?o.value=s:null),title:e(p)("map.setting-control.title")}),{default:S(()=>[m("div",Tt,[m("div",Dt,[m("div",null,[f(e(F),{label:e(p)("map.setting-control.field.split"),modelValue:e(a).split,"onUpdate:modelValue":l[1]||(l[1]=s=>e(a).split=s),onChange:l[2]||(l[2]=s=>e(n)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(p)("map.setting-control.field.vertical"),modelValue:e(a).vertical,"onUpdate:modelValue":l[3]||(l[3]=s=>e(a).vertical=s),onChange:l[4]||(l[4]=s=>e(n)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(p)("map.setting-control.field.sync"),modelValue:e(a).sync,"onUpdate:modelValue":l[5]||(l[5]=s=>e(a).sync=s),onChange:l[6]||(l[6]=s=>e(n)())},null,8,["label","modelValue"])])])])]),_:2},1040,["show","title"])):R("",!0)]),default:S(()=>[ee(i.$slots,"default")]),_:3},16))}});function Ut(t,r){var o=t.getCenter(),u=t.getZoom(),y=t.getBearing(),d=t.getPitch();r.forEach(function(p){p.jumpTo({center:o,zoom:u,bearing:y,pitch:d})})}function Ot(){var t,r=arguments.length;if(r===1)t=arguments[0];else{t=[];for(var o=0;o<r;o++)t.push(arguments[o])}var u=[];t.forEach(function(c,a){u[a]=p.bind(null,c,t.filter(function(n,i){return i!==a}))});function y(){t.forEach(function(c,a){c.on("move",u[a])})}function d(){t.forEach(function(c,a){c.off("move",u[a])})}function p(c,a){d(),Ut(c,a),y()}return y(),function(){d(),u=[],t=[]}}var At=Ot;const Ft=We(At);function Gt(t,r,o){let u=o.getBoundingClientRect();const y=()=>{u=o.getBoundingClientRect()},d=s=>{let L=("touches"in s?s.touches[0].clientX:s.clientX)-u.left;return L=Math.max(0,Math.min(L,u.width)),L},p=s=>{const $=`translate(${s}px, 0)`;t.style.transform=$,t.style.webkitTransform=$,r.style.clip=`rect(0, ${s}px, ${u.height}px, 0)`,o.style.clip=`rect(0, 999em, ${u.height}px, ${s}px)`},c=s=>{p(d(s))},a=()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",a)},n=()=>{document.removeEventListener("touchmove",c),document.removeEventListener("touchend",n)},i=s=>{"touches"in s?(document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",n)):(document.addEventListener("mousemove",c),document.addEventListener("mouseup",a))};t.addEventListener("mousedown",i),t.addEventListener("touchstart",i,{passive:!1});const l=()=>{t.removeEventListener("mousedown",i),t.removeEventListener("touchstart",i),r.style.clip="",o.style.clip=""},v=u.width/2;return p(v),{clear:l,resize:y}}function Nt(t,r,o){let u=o.getBoundingClientRect();const y=()=>{u=o.getBoundingClientRect(),p(u.height/2)},d=l=>{const s=("touches"in l?l.touches[0].clientY:l.clientY)-u.top;return Math.max(0,Math.min(s,u.height))},p=l=>{t.style.transform=`translateY(${l}px)`,r.style.clipPath=`inset(0px 0px ${u.height-l}px 0px)`,o.style.clipPath=`inset(${l}px 0px 0px 0px)`},c=l=>{l.preventDefault(),p(d(l))},a=()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",a)},n=l=>{"touches"in l?(document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",a)):(document.addEventListener("mousemove",c),document.addEventListener("mouseup",a))};t.addEventListener("mousedown",n),t.addEventListener("touchstart",n,{passive:!1});const i=()=>{t.removeEventListener("mousedown",n),t.removeEventListener("touchstart",n),a(),r.style.clipPath="",o.style.clipPath=""};return p(u.height/2),{clear:i,resize:y}}const Yt={key:0,class:""},jt=["mapId"],Xt=["id"],qt=["id"],Kt=["id"],Wt=["id"],Ht=Y({__name:"MapCompare",props:{mapboxAccessToken:{type:String,default:""},initOptions:{type:Object,default:()=>({attributionControl:!1,zoomControl:!1})},dragId:{type:String}},emits:["map-loaded","map-destroy"],setup(t,{emit:r}){const o=He({mobile:0,tablet:640,laptop:1024,desktop:1280}),u=t;function y(){if(window.WebGLRenderingContext){const C=document.createElement("canvas");try{const _=C.getContext("webgl2")||C.getContext("webgl");if(_&&typeof _.getParameter=="function")return!0}catch{}return!1}return!1}const d=r,p=x(2),c=x(y()),a=x(!1),n=x(Je()),i=Ze(n.value);Q(()=>{se(()=>{l(),window.addEventListener("resize",l)})});function l(){V&&V()}Le(()=>{window.removeEventListener("resize",l),Ae()});let v=[];const s=E(()=>`map-draggable-${n.value}`),$=E(()=>`bottom-right-${n.value}`),L=E(()=>`bottom-left-${n.value}`),I=E(()=>`top-right-${n.value}`),A=E(()=>`top-left-${n.value}`);he("$map.dragId",u.dragId||s.value),he("$map.id",n.value);const h=o.smallerOrEqual("tablet");function B(C,_){v[_]=C,Ue()}function z(C,_){delete v[_]}let b,M,V;const U=x(null),j=x([]),X=x([]),T=x({compare:!0,split:!0,sync:!0,vertical:!1}),J=E(()=>T.value.compare&&T.value.split);function Ue(){if(!v||Array.from({length:p.value},(_,P)=>P).some(_=>!v[_]))return;a.value=!0,se(()=>{d("map-loaded",{id:n.value,maps:v})}),v.forEach(_=>{_&&_.resize()}),i.initMaps(v),Te(n.value),ye(),me(n.value).on(ae.set,Oe)}function Oe(C){T.value=C,ye()}function Ae(){b&&b(),M&&M(),i.removeMap(),se(()=>{v=[]})}function ye(){var C,_,P,D;if(b&&b(),M&&M(),p.value=T.value.compare?2:1,J.value&&U.value){const q=T.value.vertical?Nt(U.value,(C=j.value)==null?void 0:C[0].$el,(_=j.value)==null?void 0:_[1].$el):Gt(U.value,(P=j.value)==null?void 0:P[0].$el,(D=j.value)==null?void 0:D[1].$el);b=q.clear,V=q.resize}T.value.sync&&(M=Ft(v)),v.forEach(q=>{q&&q.resize()})}let Z;const Fe=Qe.debounce(C=>{const{width:_,height:P}=C.contentRect;et(n.value,D=>{D.resize()}),V&&V()},200);return Q(()=>{Z=new ResizeObserver(C=>{for(const _ of C)Fe(_)}),X.value&&Z.observe(X.value)}),fe(()=>{Z&&X.value&&Z.unobserve(X.value)}),(C,_)=>c.value?(g(),w("div",{key:1,class:G(["map-compare-container",{"map-mobile-container":e(h)}]),mapId:n.value},[m("div",{class:"map-viewer",ref_key:"containerRef",ref:X},[m("div",{class:G(["map-compare__container",{"map-compare__split-vertical":J.value&&!T.value.vertical,"map-compare__split-horizontal":J.value&&T.value.vertical}])},[(g(!0),w(O,null,N(p.value,P=>(g(),k(tt,te({key:P,ref_for:!0},C.$attrs,{class:"map-compare__item",dragId:s.value,ref_for:!0,ref_key:"mapsRef",ref:j,onMapLoaded:D=>B(D,P-1),onMapDestroy:D=>z(D,P-1),initOptions:t.initOptions}),{default:S(()=>[a.value?ee(C.$slots,`map-${P-1}`,{key:0},void 0,!0):R("",!0)]),_:2},1040,["dragId","onMapLoaded","onMapDestroy","initOptions"]))),128)),J.value?(g(),w("div",{key:0,class:"map-compare__swiper",ref_key:"swiperRef",ref:U},_[1]||(_[1]=[m("div",{class:"compare-swiper-icon"},null,-1)]),512)):R("",!0)],2),u.dragId?R("",!0):(g(),w(O,{key:0},[m("div",{class:"right-bottom-container",id:$.value},null,8,Xt),m("div",{class:"left-bottom-container",id:L.value},null,8,qt),m("div",{class:"right-top-container",id:I.value},null,8,Kt),m("div",{class:"left-top-container",id:A.value},null,8,Wt),f(e(at),{class:"drag-container","container-id":s.value},null,8,["container-id"])],64)),a.value?ee(C.$slots,"default",{key:1},void 0,!0):R("",!0),a.value?(g(),k(nt,{key:2,mapId:n.value},null,8,["mapId"])):R("",!0)],512)],10,jt)):(g(),w("div",Yt,_[0]||(_[0]=[m("div",{class:"not-support-map"},[m("p",{class:""}," Trình duyệt của bạn không hỗ trợ hiển thị bản đồ, vui lòng đổi trình duyệt hoặc cập nhật bản mới để xem. ")],-1)])))}}),Jt=oe(Ht,[["__scopeId","data-v-5225ef93"]]),Zt={class:"base-map-card"},Qt={class:"base-map-card__image"},ea={class:"base-map-card__content"},ta=Y({__name:"CompareBaseMapCard",props:{mapId:{type:String,required:!0},title:{type:String,default:""}},setup(t){var n;const r=t,{mapId:o}=ne(r),u=ge(o.value),y=x(((n=Pe(o.value))==null?void 0:n.maps.map(i=>i.id))||[]),d=E(()=>c.value.map(i=>i.currentBaseMap)),p=E(()=>c.value.map(i=>i.baseMaps)),c=E(()=>y.value.map(i=>ze(i))),a=(i,l)=>{c.value[i].setCurrent(l)};return fe(()=>c.value.map(i=>i.remove())),(i,l)=>(g(),w("div",Zt,[m("div",Qt,[d.value?(g(),k(e(H),{key:0},{default:S(()=>[m("div",{class:G(["base-map-item-image-container",{_vertical:e(u).vertical}])},[(g(!0),w(O,null,N(d.value,(v,s)=>{var $;return g(),k(e(H),{src:($=v.value)==null?void 0:$.thumbnail,key:s,class:"base-map-item-image"},null,8,["src"])}),128))],2)]),_:1})):R("",!0)]),m("div",ea,[(g(!0),w(O,null,N(p.value,(v,s)=>(g(),w("div",{key:s,class:"base-map-card__item"},[m("div",null,"#"+W(s+1),1),m("div",null,[f(e(ot),{modelValue:d.value[s].value,items:v.value,returnObject:"",itemText:"title",itemValue:"id","onUpdate:modelValue":$=>a(s,$)},null,8,["modelValue","items","onUpdate:modelValue"])])]))),128))])]))}}),aa=oe(ta,[["__scopeId","data-v-6dd3a9ae"]]),na={class:"base-map-button__content"},oa={class:"base-map-button__title"},sa={class:""},la={key:1},ra={class:"control-container"},ia={class:"tabs-container"},ua=["onClick"],ca={class:"basemap-container"},da={class:"base-map-control-setting"},pa=["title","onClick"],ma={class:"base-map-control-setting-item__title",style:{"font-size":"14px"}},va=Y({__name:"CompareBaseMapControl",props:{...ke,baseMaps:{type:Array,default:()=>st},title:{type:String,default:""},defaultBaseMap:{type:String,default:"Open Street Map"},controlIcon:{type:String,default:""}},setup(t){var A;const r=t,{mapId:o,moduleContainerProps:u}=ne(r),y=ge(o.value),{trans:d,setLocaleDefault:p}=ve(o.value),c=x(0),a=x(((A=Pe(o.value))==null?void 0:A.maps.map(h=>h.id))||[]),n=E(()=>a.value.map(h=>ze(h))),i=E(()=>n.value.map(h=>h.currentBaseMap)),l=E(()=>n.value.map(h=>h.baseMaps));be(()=>r.baseMaps,h=>{n.value.forEach(B=>{B.setBaseMaps(h)})}),be(()=>r.defaultBaseMap,h=>{n.value.forEach(B=>{B.setDefaultBaseMap(h)})}),p({map:{basemap:{title:"Map basemap",setting:"Setting"}}});const v=E(()=>70),s={layer:it},$=x(!1);function L(h,B){n.value[h].setCurrent(B)}function I(){$.value=!$.value}return Q(()=>{n.value.forEach(h=>{h.init(r.baseMaps,r.defaultBaseMap)})}),fe(()=>{n.value.map(h=>h.remove())}),(h,B)=>(g(),k(e(Ee),te(e(u),{btnWidth:70}),{btn:S(()=>[i.value?(g(),k(e(Ve),{key:0,tooltip:t.title},{content:S(()=>[f(e(ut),{class:"clickable base-map-button__container",height:"70px",width:"70px",onClick:I},{default:S(()=>[m("div",na,[f(e(H),null,{default:S(()=>[m("div",{class:G(["base-map-item-image-container",{_vertical:e(y).vertical}])},[(g(!0),w(O,null,N(i.value,(z,b)=>{var M;return g(),k(e(H),{src:(M=z.value)==null?void 0:M.thumbnail,key:b,class:"base-map-item-image"},null,8,["src"])}),128))],2),m("div",oa,[t.controlIcon?(g(),k(e(lt),{key:0,dark:"",small:""},{default:S(()=>[rt(W(t.controlIcon),1)]),_:1})):(g(),k(e(Be),{key:1,type:"mdi",path:s.layer},null,8,["path"])),m("div",sa,W(t.title||e(d)("map.basemap.title")),1)])]),_:1})])]),_:1})]),_:1},8,["tooltip"])):(g(),w("div",la))]),draggable:S(z=>[$.value?(g(),k(e(Ie),te({key:0},z,{height:v.value*2+48+10+40,show:$.value,"onUpdate:show":B[0]||(B[0]=b=>$.value=b),"is-resizable":!1,title:e(d)("map.basemap.setting"),width:v.value*3+24}),{default:S(()=>[m("div",ra,[m("div",ia,[(g(!0),w(O,null,N(l.value,(b,M)=>(g(),w("div",{key:M,class:G(["tab-item",{_active:c.value==M}]),onClick:V=>c.value=M}," #"+W(M+1),11,ua))),128))]),m("div",ca,[m("div",da,[(g(!0),w(O,null,N(l.value[c.value].value,b=>{var M;return g(),w("div",{key:b.id,class:G(["clickable base-map-control-setting-item",{"base-map-control-setting-item__active":i.value&&i.value[c.value]&&i.value[c.value].value&&b.id==((M=i.value[c.value].value)==null?void 0:M.id)}]),style:Me({width:v.value+"px"}),title:b.title,onClick:V=>L(c.value,b)},[m("div",{style:Me({width:v.value-34+"px",height:v.value-34+"px"})},[f(e(H),{src:b.thumbnail},null,8,["src"])],4),m("div",ma,W(b.title),1)],14,pa)}),128))])])])]),_:2},1040,["height","show","title","width"])):R("",!0)]),default:S(()=>[ee(h.$slots,"default",{},void 0,!0)]),_:3},16))}}),fa=oe(va,[["__scopeId","data-v-8523fde9"]]),ya=Y({__name:"AllMapCompareView",setup(t){const r=x();function o(u){const{addDataset:y}=$t(u.id),d=K("Group test",null,!0),p=St("source",{type:"raster",tiles:["https://naturalearthtiles.roblabs.com/tiles/natural_earth_cross_blended_hypso_shaded_relief.raster/{z}/{x}/{y}.png"],maxzoom:6,bounds:[104.96327341667353,18.461221184685627,106.65936430823979,19.549518287564368]}),c=le("layer raster",[{type:"raster"}]),a=re("test raster");a.color="#0000FF";const n=K("Group layer 1",null,!0);d.add(p),n.add(a),n.add(c),d.add(n),a.addMenu(Ce()),a.addMenu(ie());const i=K("Group test",null,!0),l=wt("source",{type:"FeatureCollection",features:[]}),v=K("Group layer 1",null,!0),s=re("test area");s.color="#0000FF",s.legend=xt([{type:"text",value:{text:"text-test",value:"test-value"}},{type:"linear",value:{text:"legend linear",items:[{value:"test 1",color:"#fff"},{value:"test 2",color:"#000"},{value:"test 3",color:"red"}]}}]);const $=le("layer area",[new ue().setStyleType("area").setColor(s.color).setOpacity(.5).build()]);v.add($),v.add(s);const L=K("Group layer 2",null,!0),I=re("test point");I.color="#ff0000",I.legend=Lt("color",{text:"color-test",color:"#fff"});const A=le("layer point",[new ue().setStyleType("point").setColor(I.color).setOpacity(I.opacity).build(),new ue().setStyleType("line").setColor(I.color).setOpacity(.5).build()]);s.addMenus([ie(),Ce(),kt()]),I.addMenus([ie()]);const h=$e("metadata for list2",{bbox:[105.88454157202995,20.878811643339404,106.16710803591963,21.0854254401454]}),B=$e("metadata",{bbox:[104.96327341667353,18.461221184685627,107.53334783357559,20.18022781865689]}),z=Et("test identify"),b=Se("test identify 1"),M=Se("test identify 2");z.addMenus([ce(),de()]),b.addMenus([ce(),de()]),M.addMenus([ce(),de()]);const V={id:"test",name:"test"};s.group=V,v.add(b),I.group=V,L.add(A),L.add(I),L.add(M),L.add(h);const U=It("data management",{fields:[{text:"Name rat dai rat dai rat dai rat dai",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"}]});U.setItems([{id:"1",name:"feature 1",geometry:{coordinates:[[[104.96327341667353,19.549518287564368],[104.96327341667353,18.461221184685627],[106.65936430823979,18.461221184685627],[106.65936430823979,19.549518287564368],[104.96327341667353,19.549518287564368]]],type:"Polygon"}},{id:"2",name:"feature 2",geometry:{coordinates:[[[105.80782070639765,20.18022781865689],[105.80782070639765,18.841791883714322],[107.53334783357559,18.841791883714322],[107.53334783357559,20.18022781865689],[105.80782070639765,20.18022781865689]]],type:"Polygon"}}]),i.add(l),i.add(U),i.add(v),i.add(L),i.add(z),i.add(B),y(d),y(i)}return(u,y)=>(g(),k(e(Jt),{ref_key:"mapRef",ref:r,onMapLoaded:o},{default:S(()=>[f(e(ct)),f(e(Rt)),f(e(dt),{position:"top-right"}),f(e(pt),{position:"top-left",show:""},{endList:S(({mapId:d})=>[f(e(aa),{mapId:d},null,8,["mapId"]),f(e(zt),{mapId:d},null,8,["mapId"])]),_:1}),f(e(mt),{position:"top-right",immediately:""}),f(e(vt),{position:"top-right"}),f(e(ft)),f(e(gt)),f(e(yt)),f(e(_t)),f(e(ht)),f(e(bt)),f(e(Mt)),f(e(fa),{position:"bottom-left"}),f(e(Ct))]),_:1},512))}});export{ya as default};
