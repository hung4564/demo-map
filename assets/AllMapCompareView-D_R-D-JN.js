import{q as ye,t as Se,v as xe,x as me,y as de,z as Ge,C as x,E as Q,G as Le,d as Y,H as oe,I as ve,k as S,o as g,b as m,a as f,u as e,J as F,K as ne,N as Ie,O as Ye,c as I,P as ke,Q as je,R as Xe,w,S as ee,T as R,U as Ee,V as te,W as We,X as Be,Y as qe,Z as Ve,$ as Ke,a0 as Pe,a1 as He,a2 as Je,a3 as Ze,a4 as Qe,a5 as se,a6 as k,a7 as he,a8 as et,a9 as tt,aa as fe,ab as N,F as O,r as G,ac as at,ad as ot,M as nt,ae as ze,af as De,ag as H,ah as K,ai as st,aj as be,ak as lt,al as rt,am as it,an as ut,ao as ct,ap as Me,aq as pt,ar as dt,as as mt,at as vt,_ as ft,au as gt,f as _t,av as yt,g as ht,h as bt,i as Mt,j as Ct,aw as $t,ax as wt,ay as q,az as St,aA as le,aB as re,aC as Ce,aD as ie,aE as xt,aF as Lt,L as ue,aG as It,aH as kt,aI as $e,aJ as Et,aK as we,aL as ce,aM as pe,aN as Bt}from"./index-CBvdyeUG.js";const ae={set:"map:compare:set-setting"};function Te(t){Se(xe,t,"store").debug("init"),Ge(t,de.MAP_COMPARE,{setting:{compare:!0,split:!0,sync:!0,vertical:!1}})}function Re(t){const r=ye(t,de.MAP_COMPARE);return r||(Te(t),ye(t,de.MAP_COMPARE))}function ge(t){const r=Re(t);return r==null?void 0:r.setting}function Vt(t,r){Se(xe,t,"store").debug("updateMapCompareSetting",r);const n=Re(t);n&&(n.setting={...n.setting,...r}),me(t).emit(ae.set,{...n==null?void 0:n.setting,...r})}const Ue=(t,{onChange:r}={})=>{const n=x(ge(t)||{});function u(){Vt(t,n.value)}function y(d){n.value=d,r&&r(d)}const p=me(t);return Q(()=>{p.on(ae.set,y)}),Le(()=>{p.off(ae.set,y)}),{updateSetting:u,setting:n}},Pt={class:"setting-field-container"},zt=Y({__name:"CompareSettingCard",props:{mapId:{type:String,required:!0}},setup(t){const r=t,{mapId:n}=oe(r),{trans:u,setLocaleDefault:y}=ve(r.mapId);y({map:{"setting-control":{title:"Setting",field:{compare:"compare",split:"split",sync:"sync",vertical:"vertical"},btn:{apply:"Apply"}}}});const{setting:p,updateSetting:d}=Ue(n.value);return(c,a)=>(g(),S("div",Pt,[m("div",null,[f(e(F),{label:e(u)("map.setting-control.field.split"),modelValue:e(p).split,"onUpdate:modelValue":a[0]||(a[0]=o=>e(p).split=o),onChange:a[1]||(a[1]=o=>e(d)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(u)("map.setting-control.field.vertical"),modelValue:e(p).vertical,"onUpdate:modelValue":a[2]||(a[2]=o=>e(p).vertical=o),onChange:a[3]||(a[3]=o=>e(d)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(u)("map.setting-control.field.sync"),modelValue:e(p).sync,"onUpdate:modelValue":a[4]||(a[4]=o=>e(p).sync=o),onChange:a[5]||(a[5]=o=>e(d)())},null,8,["label","modelValue"])])]))}}),Dt=ne(zt,[["__scopeId","data-v-bd61d51f"]]),Tt={class:"setting-container"},Rt={class:"setting-field-container"},Ut=Y({__name:"CompareSettingControl",props:Ie({mapId:{},dragId:{},btnWidth:{},position:{},controlVisible:{type:Boolean},order:{},show:{type:Boolean}},{...Pe}),setup(t){const r=t,[n,u]=Ye(r.show),{mapId:y,moduleContainerProps:p}=oe(r),{trans:d,setLocaleDefault:c}=ve(y.value);c({map:{"setting-control":{title:"Setting",field:{compare:"compare",split:"split",sync:"sync",vertical:"vertical"},btn:{apply:"Apply"}}}});const{setting:a,updateSetting:o}=Ue(y.value);return(i,l)=>(g(),I(ke,je(Xe(e(p))),{btn:w(()=>[f(Be,{onClick:l[0]||(l[0]=qe(v=>e(u)(),["stop"])),tooltip:e(d)("map.setting-control.title")},{default:w(()=>[f(e(Ve),{size:18,type:"mdi",path:e(Ke)},null,8,["path"])]),_:1},8,["tooltip"])]),draggable:w(v=>[e(n)?(g(),I(e(Ee),te({key:0,height:400,width:400},v,{show:e(n),"onUpdate:show":l[7]||(l[7]=s=>We(n)?n.value=s:null),title:e(d)("map.setting-control.title")}),{default:w(()=>[m("div",Tt,[m("div",Rt,[m("div",null,[f(e(F),{label:e(d)("map.setting-control.field.split"),modelValue:e(a).split,"onUpdate:modelValue":l[1]||(l[1]=s=>e(a).split=s),onChange:l[2]||(l[2]=s=>e(o)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(d)("map.setting-control.field.vertical"),modelValue:e(a).vertical,"onUpdate:modelValue":l[3]||(l[3]=s=>e(a).vertical=s),onChange:l[4]||(l[4]=s=>e(o)())},null,8,["label","modelValue"])]),m("div",null,[f(e(F),{label:e(d)("map.setting-control.field.sync"),modelValue:e(a).sync,"onUpdate:modelValue":l[5]||(l[5]=s=>e(a).sync=s),onChange:l[6]||(l[6]=s=>e(o)())},null,8,["label","modelValue"])])])])]),_:2},1040,["show","title"])):R("",!0)]),default:w(()=>[ee(i.$slots,"default")]),_:3},16))}});function Ot(t,r){var n=t.getCenter(),u=t.getZoom(),y=t.getBearing(),p=t.getPitch();r.forEach(function(d){d.jumpTo({center:n,zoom:u,bearing:y,pitch:p})})}function At(){var t,r=arguments.length;if(r===1)t=arguments[0];else{t=[];for(var n=0;n<r;n++)t.push(arguments[n])}var u=[];t.forEach(function(c,a){u[a]=d.bind(null,c,t.filter(function(o,i){return i!==a}))});function y(){t.forEach(function(c,a){c.on("move",u[a])})}function p(){t.forEach(function(c,a){c.off("move",u[a])})}function d(c,a){p(),Ot(c,a),y()}return y(),function(){p(),u=[],t=[]}}var Ft=At;const Nt=He(Ft);function Gt(t,r,n){let u=n.getBoundingClientRect();const y=()=>{u=n.getBoundingClientRect()},p=s=>{let L=("touches"in s?s.touches[0].clientX:s.clientX)-u.left;return L=Math.max(0,Math.min(L,u.width)),L},d=s=>{const $=`translate(${s}px, 0)`;t.style.transform=$,t.style.webkitTransform=$,r.style.clip=`rect(0, ${s}px, ${u.height}px, 0)`,n.style.clip=`rect(0, 999em, ${u.height}px, ${s}px)`},c=s=>{d(p(s))},a=()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",a)},o=()=>{document.removeEventListener("touchmove",c),document.removeEventListener("touchend",o)},i=s=>{"touches"in s?(document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",o)):(document.addEventListener("mousemove",c),document.addEventListener("mouseup",a))};t.addEventListener("mousedown",i),t.addEventListener("touchstart",i,{passive:!1});const l=()=>{t.removeEventListener("mousedown",i),t.removeEventListener("touchstart",i),r.style.clip="",n.style.clip=""},v=u.width/2;return d(v),{clear:l,resize:y}}function Yt(t,r,n){let u=n.getBoundingClientRect();const y=()=>{u=n.getBoundingClientRect(),d(u.height/2)},p=l=>{const s=("touches"in l?l.touches[0].clientY:l.clientY)-u.top;return Math.max(0,Math.min(s,u.height))},d=l=>{t.style.transform=`translateY(${l}px)`,r.style.clipPath=`inset(0px 0px ${u.height-l}px 0px)`,n.style.clipPath=`inset(${l}px 0px 0px 0px)`},c=l=>{l.preventDefault(),d(p(l))},a=()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",a)},o=l=>{"touches"in l?(document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",a)):(document.addEventListener("mousemove",c),document.addEventListener("mouseup",a))};t.addEventListener("mousedown",o),t.addEventListener("touchstart",o,{passive:!1});const i=()=>{t.removeEventListener("mousedown",o),t.removeEventListener("touchstart",o),a(),r.style.clipPath="",n.style.clipPath=""};return d(u.height/2),{clear:i,resize:y}}const jt={key:0,class:""},Xt=["mapId"],Wt=["id"],qt=["id"],Kt=["id"],Ht=["id"],Jt=Y({__name:"MapCompare",props:{mapboxAccessToken:{type:String,default:""},initOptions:{type:Object,default:()=>({attributionControl:!1,zoomControl:!1})},dragId:{type:String}},emits:["map-loaded","map-destroy"],setup(t,{emit:r}){const n=Je({mobile:0,tablet:640,laptop:1024,desktop:1280}),u=t;function y(){if(window.WebGLRenderingContext){const C=document.createElement("canvas");try{const h=C.getContext("webgl2")||C.getContext("webgl");if(h&&typeof h.getParameter=="function")return!0}catch{}return!1}return!1}const p=r,d=x(2),c=x(y()),a=x(!1),o=x(Ze()),i=Qe(o.value);Q(()=>{se(()=>{l(),window.addEventListener("resize",l)})});function l(){V&&V()}Le(()=>{window.removeEventListener("resize",l),Fe()});let v=[];const s=k(()=>`map-draggable-${o.value}`),$=k(()=>`bottom-right-${o.value}`),L=k(()=>`bottom-left-${o.value}`),E=k(()=>`top-right-${o.value}`),A=k(()=>`top-left-${o.value}`);he("$map.dragId",u.dragId||s.value),he("$map.id",o.value);const _=n.smallerOrEqual("tablet");function B(C,h){v[h]=C,Oe()}function z(C,h){delete v[h]}let b,M,V;const U=x(null),j=x([]),X=x([]),D=x({compare:!0,split:!0,sync:!0,vertical:!1}),J=k(()=>D.value.compare&&D.value.split);function Oe(){if(!v||Array.from({length:d.value},(h,P)=>P).some(h=>!v[h]))return;a.value=!0,se(()=>{p("map-loaded",{id:o.value,maps:v})}),v.forEach(h=>{h&&h.resize()}),i.initMaps(v),Te(o.value),_e(),me(o.value).on(ae.set,Ae)}function Ae(C){D.value=C,_e()}function Fe(){b&&b(),M&&M(),i.removeMap(),se(()=>{v=[]})}function _e(){var C,h,P,T;if(b&&b(),M&&M(),d.value=D.value.compare?2:1,J.value&&U.value){const W=D.value.vertical?Yt(U.value,(C=j.value)==null?void 0:C[0].$el,(h=j.value)==null?void 0:h[1].$el):Gt(U.value,(P=j.value)==null?void 0:P[0].$el,(T=j.value)==null?void 0:T[1].$el);b=W.clear,V=W.resize}D.value.sync&&(M=Nt(v)),v.forEach(W=>{W&&W.resize()})}let Z;const Ne=et.debounce(C=>{const{width:h,height:P}=C.contentRect;tt(o.value,T=>{T.resize()}),V&&V()},200);return Q(()=>{Z=new ResizeObserver(C=>{for(const h of C)Ne(h)}),X.value&&Z.observe(X.value)}),fe(()=>{Z&&X.value&&Z.unobserve(X.value)}),(C,h)=>c.value?(g(),S("div",{key:1,class:N(["map-compare-container",{"map-mobile-container":e(_)}]),mapId:o.value},[m("div",{class:"map-viewer",ref_key:"containerRef",ref:X},[m("div",{class:N(["map-compare__container",{"map-compare__split-vertical":J.value&&!D.value.vertical,"map-compare__split-horizontal":J.value&&D.value.vertical}])},[(g(!0),S(O,null,G(d.value,P=>(g(),I(nt,te({key:P,ref_for:!0},C.$attrs,{class:"map-compare__item",dragId:s.value,ref_for:!0,ref_key:"mapsRef",ref:j,onMapLoaded:T=>B(T,P-1),onMapDestroy:T=>z(T,P-1),initOptions:t.initOptions}),{default:w(()=>[a.value?ee(C.$slots,`map-${P-1}`,{key:0},void 0,!0):R("",!0)]),_:2},1040,["dragId","onMapLoaded","onMapDestroy","initOptions"]))),128)),J.value?(g(),S("div",{key:0,class:"map-compare__swiper",ref_key:"swiperRef",ref:U},h[1]||(h[1]=[m("div",{class:"compare-swiper-icon"},null,-1)]),512)):R("",!0)],2),u.dragId?R("",!0):(g(),S(O,{key:0},[m("div",{class:"right-bottom-container",id:$.value},null,8,Wt),m("div",{class:"left-bottom-container",id:L.value},null,8,qt),m("div",{class:"right-top-container",id:E.value},null,8,Kt),m("div",{class:"left-top-container",id:A.value},null,8,Ht),f(e(at),{class:"drag-container","container-id":s.value},null,8,["container-id"])],64)),a.value?ee(C.$slots,"default",{key:1},void 0,!0):R("",!0),a.value?(g(),I(ot,{key:2,mapId:o.value},null,8,["mapId"])):R("",!0)],512)],10,Xt)):(g(),S("div",jt,h[0]||(h[0]=[m("div",{class:"not-support-map"},[m("p",{class:""}," Trình duyệt của bạn không hỗ trợ hiển thị bản đồ, vui lòng đổi trình duyệt hoặc cập nhật bản mới để xem. ")],-1)])))}}),Zt=ne(Jt,[["__scopeId","data-v-5225ef93"]]),Qt={class:"base-map-card"},ea={class:"base-map-card__image"},ta={class:"base-map-card__content"},aa=Y({__name:"CompareBaseMapCard",props:{mapId:{type:String,required:!0},title:{type:String,default:""}},setup(t){var o;const r=t,{mapId:n}=oe(r),u=ge(n.value),y=x(((o=ze(n.value))==null?void 0:o.maps.map(i=>i.id))||[]),p=k(()=>c.value.map(i=>i.currentBaseMap)),d=k(()=>c.value.map(i=>i.baseMaps)),c=k(()=>y.value.map(i=>De(i))),a=(i,l)=>{c.value[i].setCurrent(l)};return fe(()=>c.value.map(i=>i.remove())),(i,l)=>(g(),S("div",Qt,[m("div",ea,[p.value?(g(),I(e(H),{key:0},{default:w(()=>[m("div",{class:N(["base-map-item-image-container",{_vertical:e(u).vertical}])},[(g(!0),S(O,null,G(p.value,(v,s)=>{var $;return g(),I(e(H),{src:($=v.value)==null?void 0:$.thumbnail,key:s,class:"base-map-item-image"},null,8,["src"])}),128))],2)]),_:1})):R("",!0)]),m("div",ta,[(g(!0),S(O,null,G(d.value,(v,s)=>(g(),S("div",{key:s,class:"base-map-card__item"},[m("div",null,"#"+K(s+1),1),m("div",null,[f(e(st),{modelValue:p.value[s].value,items:v.value,returnObject:"",itemText:"title",itemValue:"id","onUpdate:modelValue":$=>a(s,$)},null,8,["modelValue","items","onUpdate:modelValue"])])]))),128))])]))}}),oa=ne(aa,[["__scopeId","data-v-6dd3a9ae"]]),na={class:"base-map-button__content"},sa={class:"base-map-button__title"},la={class:""},ra={key:1},ia={class:"control-container"},ua={class:"tabs-container"},ca=["onClick"],pa={class:"basemap-container"},da={class:"base-map-control-setting"},ma=["title","onClick"],va={class:"base-map-control-setting-item__title",style:{"font-size":"14px"}},fa=Y({__name:"CompareBaseMapControl",props:Ie({mapId:{},dragId:{},btnWidth:{},position:{},controlVisible:{type:Boolean},order:{},baseMaps:{},title:{},defaultBaseMap:{},controlIcon:{}},{...Pe,baseMaps:()=>ct,title:"",defaultBaseMap:"Open Street Map",controlIcon:""}),setup(t){var A;const r=t,{mapId:n,moduleContainerProps:u}=oe(r),y=ge(n.value),{trans:p,setLocaleDefault:d}=ve(n.value),c=x(0),a=x(((A=ze(n.value))==null?void 0:A.maps.map(_=>_.id))||[]),o=k(()=>a.value.map(_=>De(_))),i=k(()=>o.value.map(_=>_.currentBaseMap)),l=k(()=>o.value.map(_=>_.baseMaps));be(()=>r.baseMaps,_=>{o.value.forEach(B=>{B.setBaseMaps(_)})}),be(()=>r.defaultBaseMap,_=>{o.value.forEach(B=>{B.setDefaultBaseMap(_)})}),d({map:{basemap:{title:"Map basemap",setting:"Setting"}}});const v=k(()=>70),s={layer:ut},$=x(!1);function L(_,B){o.value[_].setCurrent(B)}function E(){$.value=!$.value}return Q(()=>{o.value.forEach(_=>{_.init(r.baseMaps,r.defaultBaseMap)})}),fe(()=>{o.value.map(_=>_.remove())}),(_,B)=>(g(),I(e(ke),te(e(u),{btnWidth:70}),{btn:w(()=>[i.value?(g(),I(e(Be),{key:0,tooltip:_.title},{content:w(()=>[f(e(lt),{class:"clickable base-map-button__container",height:"70px",width:"70px",onClick:E},{default:w(()=>[m("div",na,[f(e(H),null,{default:w(()=>[m("div",{class:N(["base-map-item-image-container",{_vertical:e(y).vertical}])},[(g(!0),S(O,null,G(i.value,(z,b)=>{var M;return g(),I(e(H),{src:(M=z.value)==null?void 0:M.thumbnail,key:b,class:"base-map-item-image"},null,8,["src"])}),128))],2),m("div",sa,[_.controlIcon?(g(),I(e(rt),{key:0,dark:"",small:""},{default:w(()=>[it(K(_.controlIcon),1)]),_:1})):(g(),I(e(Ve),{key:1,type:"mdi",path:s.layer},null,8,["path"])),m("div",la,K(_.title||e(p)("map.basemap.title")),1)])]),_:1})])]),_:1})]),_:1},8,["tooltip"])):(g(),S("div",ra))]),draggable:w(z=>[$.value?(g(),I(e(Ee),te({key:0},z,{height:v.value*2+48+10+40,show:$.value,"onUpdate:show":B[0]||(B[0]=b=>$.value=b),"is-resizable":!1,title:e(p)("map.basemap.setting"),width:v.value*3+24}),{default:w(()=>[m("div",ia,[m("div",ua,[(g(!0),S(O,null,G(l.value,(b,M)=>(g(),S("div",{key:M,class:N(["tab-item",{_active:c.value==M}]),onClick:V=>c.value=M}," #"+K(M+1),11,ca))),128))]),m("div",pa,[m("div",da,[(g(!0),S(O,null,G(l.value[c.value].value,b=>{var M;return g(),S("div",{key:b.id,class:N(["clickable base-map-control-setting-item",{"base-map-control-setting-item__active":i.value&&i.value[c.value]&&i.value[c.value].value&&b.id==((M=i.value[c.value].value)==null?void 0:M.id)}]),style:Me({width:v.value+"px"}),title:b.title,onClick:V=>L(c.value,b)},[m("div",{style:Me({width:v.value-34+"px",height:v.value-34+"px"})},[f(e(H),{src:b.thumbnail},null,8,["src"])],4),m("div",va,K(b.title),1)],14,ma)}),128))])])])]),_:2},1040,["height","show","title","width"])):R("",!0)]),default:w(()=>[ee(_.$slots,"default",{},void 0,!0)]),_:3},16))}}),ga=ne(fa,[["__scopeId","data-v-042238ee"]]),ya=Y({__name:"AllMapCompareView",setup(t){const r=x();function n(u){const{addDataset:y}=wt(u.id),p=q("Group test",null,!0),d=St("source",{type:"raster",tiles:["https://naturalearthtiles.roblabs.com/tiles/natural_earth_cross_blended_hypso_shaded_relief.raster/{z}/{x}/{y}.png"],maxzoom:6,bounds:[104.96327341667353,18.461221184685627,106.65936430823979,19.549518287564368]}),c=le("layer raster",[{type:"raster"}]),a=re("test raster");a.color="#0000FF";const o=q("Group layer 1",null,!0);p.add(d),o.add(a),o.add(c),p.add(o),a.addMenu(Ce()),a.addMenu(ie({location:"bottom"}));const i=q("Group test",null,!0),l=xt("source",{type:"FeatureCollection",features:[]}),v=q("Group layer 1",null,!0),s=re("test area");s.color="#0000FF",s.legend=Lt([{type:"text",value:{text:"text-test",value:"test-value"}},{type:"linear",value:{text:"legend linear",items:[{value:"test 1",color:"#fff"},{value:"test 2",color:"#000"},{value:"test 3",color:"red"}]}}]);const $=le("layer area",[new ue().setStyleType("area").setColor(s.color).setOpacity(.5).build()]);v.add($),v.add(s);const L=q("Group layer 2",null,!0),E=re("test point");E.color="#ff0000",E.legend=It("color",{text:"color-test",color:"#fff"});const A=le("layer point",[new ue().setStyleType("point").setColor(E.color).setOpacity(E.opacity).build(),new ue().setStyleType("line").setColor(E.color).setOpacity(.5).build()]);s.addMenus([ie({location:"bottom"}),Ce(),kt()]),E.addMenus([ie()]);const _=$e("metadata for list2",{bbox:[105.88454157202995,20.878811643339404,106.16710803591963,21.0854254401454]}),B=$e("metadata",{bbox:[104.96327341667353,18.461221184685627,107.53334783357559,20.18022781865689]}),z=Et("test identify"),b=we("test identify 1"),M=we("test identify 2");z.addMenus([ce(),pe()]),b.addMenus([ce(),pe()]),M.addMenus([ce(),pe()]);const V={id:"test",name:"test"};s.group=V,v.add(b),E.group=V,L.add(A),L.add(E),L.add(M),L.add(_);const U=Bt("data management",{fields:[{text:"Name rat dai rat dai rat dai rat dai",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"},{text:"Name",value:"name"}]});U.setItems([{id:"1",name:"feature 1",geometry:{coordinates:[[[104.96327341667353,19.549518287564368],[104.96327341667353,18.461221184685627],[106.65936430823979,18.461221184685627],[106.65936430823979,19.549518287564368],[104.96327341667353,19.549518287564368]]],type:"Polygon"}},{id:"2",name:"feature 2",geometry:{coordinates:[[[105.80782070639765,20.18022781865689],[105.80782070639765,18.841791883714322],[107.53334783357559,18.841791883714322],[107.53334783357559,20.18022781865689],[105.80782070639765,20.18022781865689]]],type:"Polygon"}}]),i.add(l),i.add(U),i.add(v),i.add(L),i.add(z),i.add(B),y(p),y(i)}return(u,y)=>(g(),I(e(Zt),{ref_key:"mapRef",ref:r,onMapLoaded:n},{default:w(()=>[f(e(pt)),f(e(Ut)),f(e(dt),{position:"top-right"}),f(e(mt),{position:"top-left",show:""},{endList:w(({mapId:p})=>[f(e(oa),{mapId:p},null,8,["mapId"]),f(e(Dt),{mapId:p},null,8,["mapId"])]),_:1}),f(e(vt),{position:"top-right",immediately:""}),f(e(ft),{position:"top-right"}),f(e(gt)),f(e(_t)),f(e(yt)),f(e(ht)),f(e(bt)),f(e(Mt)),f(e(Ct)),f(e(ga),{position:"bottom-left"}),f(e($t))]),_:1},512))}});export{ya as default};
